<header class="section-title" *ngIf="!isSummary">
  <h3 class="d-flex justify-content-between w-100">
    <span class="query-abstract">{{ queryDetails?.Query?.Abstract }}</span>
    <span class="query-id">{{ queryDetails?.Query?.Id }}</span>
  </h3>
</header>
<section class="server-summary" *ngIf="!!isSummary || !!queryDetails?.Metrics2">
  <header class="server-summary-title section-title" *ngIf="!!isSummary">
    <h3 class="d-inline">
      Server Summary
    </h3>
  </header>
  <ngb-accordion [activeIds]="accordionIds.serverSummary">
    <ngb-panel id="metrics-table" class="accordion-inner-table">
      <ng-template ngbPanelTitle>
        <div class="accordion-title">
          <h5>Metrics&nbsp;</h5>
          <span class="query-information" *ngIf="!isSummary">
            Query first seen: <strong class="first-seen-time" [class.first-seen]="isFirstSeen">{{ firstSeen }}</strong>
            Last seen: <strong>{{ lastSeen }}</strong>
          </span>
        </div>
      </ng-template>
      <ng-template ngbPanelContent>
        <div class="table-wrapper metrics-table" *ngIf="!isLoading">
          <div class="table-header grid-container table-header-row">
            <div>Metrics</div>
            <div>Rate/Sec</div>
            <div>Sum</div>
            <div>Per Query Stats</div>
          </div>
          <div class="table-body">
            <div class="table-body-row grid-container">
              <div><span>Query Count</span></div>
              <div class="flex-container">
                <div class=" justify-content-start">
                  <span class="unit unit-per-sec">{{ queryDetails?.Metrics2?.Query_count_per_sec | humanize : 'number' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                     data-tooltip="Loading..." xkey="Ts" ykey="Query_count_per_sec" measurement="number">
                </div>
              </div>
              <div>
                <span>{{ queryDetails?.Metrics2?.Query_count | humanize : 'number' }}
                  <small>
                    <span *ngIf="!isSummary" class="text-primary non-summary-info">
                      <span>{{ queryDetails?.Metrics2?.Query_count_of_total | humanize : 'percent' }}</span> of total
                    </span>
                  </small>
                </span>
              </div>
              <div class="flex-container">
                <div class=" justify-content-start">
                  <span class="unit unit-avg">{{ queryDetails?.Metrics2?.Query_time_avg | humanize : 'time' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip"
                     data-tooltip="Loading..."
                     [appLatencyChart]="queryDetails?.Metrics2"
                     measurement="time"
                     metricPrefix="Query_time">
                </div>
              </div>
            </div>
            <div class="table-body-row grid-container">
              <div><span>Query Time</span></div>
              <div class="flex-container">
                <div class=" justify-content-start">
                  <span class="unit unit-load">{{ queryDetails?.Metrics2?.Query_time_sum_per_sec | humanize : 'number' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                     data-tooltip="Loading..." xkey="Ts" ykey="Query_time_sum_per_sec" measurement="number">
                </div>
              </div>
              <div class="">
                <span class="sum text-left">{{ queryDetails?.Metrics2?.Query_time_sum | humanize : 'time' }}
                  <small>
                    <span *ngIf="!isSummary" class="text-primary non-summary-info">
                      <span>{{ queryDetails?.Metrics2?.Query_time_sum_of_total | humanize : 'percent' }}</span> of total
                    </span>
                  </small>
                </span>
              </div>
              <div class="flex-container">
                <div class=" justify-content-start">
                  <span class="unit unit-avg">{{ queryDetails?.Metrics2?.Query_time_avg | humanize : 'time' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip"
                     data-tooltip="Loading..."
                     [appLatencyChart]="queryDetails?.Metrics2"
                     measurement="time"
                     metricPrefix="Query_time">
                </div>
              </div>
            </div>
            <div *ngIf="queryDetails?.Metrics2?.Lock_time_sum" class="table-body-row grid-container">
              <div><span>Lock Time</span></div>
              <div class="flex-container">
                <div class=" justify-content-start">
                  <span class="unit unit-avg-load">{{ queryDetails?.Metrics2?.Lock_time_sum_per_sec | humanize : 'number' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                     data-tooltip="Loading..."
                     xkey="Ts" ykey="Lock_time_sum_per_sec"
                     measurement="number">

                </div>
              </div>
              <div class="">
                <span class="sum text-left">{{ queryDetails?.Metrics2?.Lock_time_sum | humanize : 'time' }}
                  <small>
                    <span *ngIf="!isSummary" class="text-primary non-summary-info">
                      <span>{{ queryDetails?.Metrics2?.Lock_time_sum_of_total | humanize : 'percent'}}</span> of total
                    </span>
                    <span class="text-success">
                      <span>{{ queryDetails?.Metrics2?.Lock_time_avg_per_query_time | humanize : 'percent' }}</span> of query time
                    </span>
                  </small>
                </span>
              </div>
              <div class="flex-container">
                <div class=" justify-content-start">
                  <span class="unit unit-avg">{{ queryDetails?.Metrics2?.Lock_time_avg | humanize : 'time' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="time"
                     [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="Lock_time">
                </div>
              </div>
            </div>
            <div *ngIf="queryDetails?.Metrics2?.InnoDB_rec_lock_wait_sum" class="table-body-row grid-container">
              <div class="cell-overlay position-static"><span>Innodb Row Lock Wait</span></div>
              <div class="flex-container">
                <div class=" justify-content-start">
                  <span class="unit unit-avg-load">
                    {{ queryDetails?.Metrics2?.InnoDB_rec_lock_wait_sum_per_sec | humanize :'number' }}
                  </span>
                </div>
                <div class="scaling-svg-container app-tooltip"
                     [appLoadSparklines]="queryDetails?.Sparks2"
                     data-tooltip="Loading..."
                     xkey="Ts" ykey="InnoDB_rec_lock_wait_sum_per_sec"
                     measurement="number">
                </div>
              </div>
              <div>
                <span class="sum text-left">{{ queryDetails?.Metrics2?.InnoDB_rec_lock_wait_sum | humanize : 'time' }}
                  <small>
                    <span *ngIf="queryDetails?.Metrics2?.InnoDB_rec_lock_wait_sum_of_total" class="text-primary">
                      <span>{{ queryDetails?.Metrics2?.InnoDB_rec_lock_wait_sum_of_total | humanize : 'percent' }}</span> of total
                    </span>
                    <span class="text-success">
                      <span>{{ queryDetails?.Metrics2?.InnoDB_rec_lock_wait_avg_per_query_time | humanize : 'percent' }}</span> of query time
                    </span>
                  </small>
                </span>
              </div>
              <div class="flex-container">
                <div class=" justify-content-start">
                  <span
                    class="unit unit-avg">{{ queryDetails?.Metrics2?.InnoDB_rec_lock_wait_avg | humanize : 'time' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip"
                     data-tooltip="Loading..." measurement="time"
                     [appLatencyChart]="queryDetails?.Metrics2"
                     metricPrefix="InnoDB_rec_lock_wait">
                </div>
              </div>
            </div>
            <div *ngIf="queryDetails?.Metrics2?.InnoDB_IO_r_wait_sum" class="table-body-row grid-container">
              <div class="justify-content-start">
                <span>Innodb IO Read Wait</span>
              </div>
              <div class="flex-container">
                <div class=" justify-content-start">
                  <span class="unit unit-avg-load">{{ queryDetails?.Metrics2?.InnoDB_IO_r_wait_sum_per_sec | humanize :'number' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                     data-tooltip="Loading..." xkey="Ts" ykey="InnoDB_IO_r_wait_sum_per_sec"
                     measurement="number"></div>
              </div>
              <div class="">
                <span class="sum text-left">{{ queryDetails?.Metrics2?.InnoDB_IO_r_wait_sum | humanize : 'time' }}
                  <small>
                    <span *ngIf="!isSummary" class="text-primary non-summary-info">
                      <span>{{ queryDetails?.Metrics2?.InnoDB_IO_r_wait_sum_of_total | humanize : 'percent' }}</span> of total
                    </span>
                    <span class="text-success">
                      <span>{{ queryDetails?.Metrics2?.InnoDB_IO_r_wait_avg_per_query_time | humanize : 'percent' }}</span> of query time
                    </span>
                  </small>
                </span>
              </div>
              <div class="flex-container">
                <div class=" justify-content-start">
                  <span
                    class="unit unit-avg">{{ queryDetails?.Metrics2?.InnoDB_IO_r_wait_avg | humanize : 'time' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="time"
                     [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="InnoDB_IO_r_wait">
                </div>
              </div>
            </div>
            <div *ngIf="queryDetails?.Metrics2?.InnoDB_queue_wait_sum" class="table-body-row grid-container">
              <div><span>Innodb Queue Wait</span></div>
              <div class="flex-container">
                <div class=" justify-content-start">
                  <span class="unit unit-avg-load">{{ queryDetails?.Metrics2?.InnoDB_queue_wait_sum_per_sec | humanize :'number'}}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                     data-tooltip="Loading..." xkey="Ts" ykey="InnoDB_queue_wait_sum_per_sec"
                     measurement="number">
                </div>
              </div>
              <div class="">
                <span class="sum text-left">{{ queryDetails?.Metrics2?.InnoDB_queue_wait_sum | humanize : 'time'}}
                  <small>
                    <span *ngIf="!isSummary" class="text-primary non-summary-info">
                      <span>{{ queryDetails?.Metrics2?.InnoDB_queue_wait_sum_of_total | humanize : 'percent' }}</span> of total
                    </span>
                    <span class="text-success">
                      <span>{{ queryDetails?.Metrics2?.innodbQueueWait?.InnoDB_queue_wait_avg_per_query_time | humanize : 'percent' }}</span> of query time
                    </span>
                  </small>
                </span>
              </div>
              <div class="flex-container">
                <div class=" justify-content-start">
                  <span
                    class="unit unit-avg">{{ queryDetails?.Metrics2?.InnoDB_queue_wait_avg | humanize : 'time' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="time"
                     [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="InnoDB_queue_wait">
                </div>
              </div>
            </div>
            <div *ngIf="queryDetails?.Metrics2?.InnoDB_IO_r_ops_sum" class="table-body-row grid-container">
              <div><span>Innodb Read Ops</span></div>
              <div class="flex-container">
                <div class=" justify-content-start">
                  <span class="unit-per-sec">{{ queryDetails?.Metrics2?.InnoDB_IO_r_ops_sum_per_sec | humanize :'number' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                     data-tooltip="Loading..." xkey="Ts" ykey="InnoDB_IO_r_ops_sum_per_sec"
                     measurement="number">
                </div>
              </div>
              <div class="">
                <span class="sum text-left">{{ queryDetails?.Metrics2?.InnoDB_IO_r_ops_sum | humanize : 'number' }}
                  <small>
                    <span *ngIf="!isSummary" class="text-primary non-summary-info">
                      <span>{{ queryDetails?.Metrics2?.InnoDB_IO_r_ops_sum_of_total | humanize : 'percent' }}</span> of total
                    </span>
                  </small>
                </span>
              </div>
              <div class="flex-container">
                <div class=" justify-content-start">
                  <span
                    class="unit unit-avg">{{ queryDetails?.Metrics2?.InnoDB_IO_r_ops_avg | humanize : 'number' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="number"
                     [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="InnoDB_IO_r_ops">
                </div>
              </div>
            </div>
            <div *ngIf="queryDetails?.Metrics2?.InnoDB_IO_r_bytes_sum"
                 class="table-body-row grid-container grid-container">
              <div><span>Innodb Read Bytes</span></div>
              <div class="flex-container">
                <div class=" justify-content-start">
                  <span class="unit unit-per-sec">{{ queryDetails?.Metrics2?.InnoDB_IO_r_bytes_sum_per_sec | humanize :'size'}}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                     data-tooltip="Loading..." xkey="Ts" ykey="InnoDB_IO_r_bytes_sum_per_sec"
                     measurement="size">
                </div>
              </div>
              <div class="">
                <span class="sum text-left">{{ queryDetails?.Metrics2?.InnoDB_IO_r_bytes_sum | humanize : 'size' }}
                  <small>
                    <span *ngIf="!isSummary" class="text-primary non-summary-info">
                      <span>{{ queryDetails?.Metrics2?.InnoDB_IO_r_bytes_sum_of_total | humanize : 'percent' }}</span> of total
                    </span>
                    <span class="text-success">
                      <span class="unit unit-avg">{{ queryDetails?.Metrics2?.InnoDB_IO_r_bytes_sum_per_io | humanize : 'size' }}</span> io size
                    </span>
                  </small>
                </span>
              </div>
              <div class="flex-container">
                <div class=" justify-content-start">
                  <span
                    class="unit unit-avg">{{ queryDetails?.Metrics2?.InnoDB_IO_r_bytes_avg | humanize : 'size' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="size"
                     [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="InnoDB_IO_r_bytes">
                </div>
              </div>
            </div>
            <div *ngIf="queryDetails?.Metrics2?.InnoDB_pages_distinct_sum"
                 class="table-body-row grid-container special-row">
              <div><span>Innodb Distinct Pages</span></div>
              <div>-</div>
              <div class="flex-container">
                <div class=" justify-content-start">
                  <span class="unit unit-avg">{{ queryDetails?.Metrics2?.InnoDB_pages_distinct_avg | humanize : 'number' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="number"
                     [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="InnoDB_pages_distinct">
                </div>
              </div>
            </div>
            <div *ngIf="queryDetails?.Metrics2?.QC_Hit_sum" class="table-body-row grid-container">
              <div><span>Query Cache Hits</span></div>
              <div class="flex-container">
                <div class=" justify-content-start">
                  <span
                    class="unit unit-per-sec">{{ queryDetails?.Metrics2?.QC_Hit_sum_per_sec | humanize : 'number' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                     data-tooltip="Loading..." xkey="Ts" ykey="QC_Hit_sum_per_sec" measurement="number">
                </div>
              </div>
              <div class="">
                <span class="sum text-left">{{ queryDetails?.Metrics2?.QC_Hit_sum | humanize : 'number' }}
                  <small>
                    <span *ngIf="!isSummary" class="text-primary non-summary-info">
                      <span>{{ queryDetails?.Metrics2?.QC_Hit_sum_of_total | humanize : 'percent' }}</span> of total
                   </span>
                    <span class="text-success">
                      <span>{{ queryDetails?.Metrics2?.QC_Hit_sum_per_query | humanize : 'percent'}}</span> QC hit ratio
                    </span>
                  </small>
                </span>
              </div>
              <div>
                -
              </div>
            </div>
            <div *ngIf="queryDetails?.Metrics2?.Rows_sent_sum" class="table-body-row grid-container">
              <div><span>Rows Sent</span></div>
              <div class="flex-container">
                <div class=" justify-content-start">
                  <span class="unit unit-per-sec">{{ queryDetails?.Metrics2?.Rows_sent_sum_per_sec | humanize : 'number' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                     data-tooltip="Loading..." xkey="Ts" ykey="Rows_sent_sum_per_sec" measurement="number">
                </div>
              </div>
              <div class="">
                <span class="sum text-left">{{ queryDetails?.Metrics2?.Rows_sent_sum | humanize : 'number' }}
                  <small>
                    <span *ngIf="!isSummary" class="text-primary non-summary-info">
                      <span>{{ queryDetails?.Metrics2?.Rows_sent_sum_of_total | humanize : 'percent' }}</span> of total
                    </span>
                  </small>
                </span>
              </div>
              <div class="flex-container">
                <div class=" justify-content-start">
                  <span class="unit unit-avg">{{ queryDetails?.Metrics2?.Rows_sent_avg | humanize : 'number' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="number"
                     [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="Rows_sent">
                </div>
              </div>
            </div>
            <div *ngIf="queryDetails?.Metrics2?.Bytes_sent_sum" class="table-body-row grid-container">
              <div><span>Bytes Sent</span></div>
              <div class="flex-container">
                <div class=" justify-content-start">
                  <span class="unit unit-per-sec">{{ queryDetails?.Metrics2?.Bytes_sent_sum_per_sec | humanize : 'size' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                     data-tooltip="Loading..." xkey="Ts" ykey="Bytes_sent_sum_per_sec" measurement="size">
                </div>
              </div>
              <div>
                <span class="sum text-left">{{ queryDetails?.Metrics2?.Bytes_sent_sum | humanize : 'size' }}
                  <small>
                    <span *ngIf="!isSummary" class="text-primary non-summary-info">
                      <span>{{ queryDetails?.Metrics2?.Bytes_sent_sum_of_total | humanize : 'percent' }}</span> of total
                    </span>
                    <span class="text-success" ng-if="queryDetails?.Metrics2?.Bytes_sent_sum_per_rows">
                      {{ queryDetails?.Metrics2?.Bytes_sent_sum_per_rows | humanize : 'size' }} bytes/row
                    </span>
                  </small>
                </span>
              </div>
              <div class="flex-container">
                <div class=" justify-content-start">
                  <span class="unit unit-avg">{{ queryDetails?.Metrics2?.Bytes_sent_avg | humanize : 'size' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="size"
                     [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="Bytes_sent">
                </div>
              </div>
            </div>
            <div *ngIf="queryDetails?.Metrics2?.Rows_examined_sum" class="table-body-row grid-container">
              <div><span>Rows Examined</span></div>
              <div class="flex-container">
                <div class=" justify-content-start">
                  <span class="unit unit-per-sec">{{ queryDetails?.Metrics2?.Rows_examined_sum_per_sec | humanize : 'number' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                     data-tooltip="Loading..." xkey="Ts" ykey="Rows_examined_sum_per_sec" measurement="number">
                </div>
              </div>
              <div class="">
                <span class="sum text-left">{{ queryDetails?.Metrics2?.Rows_examined_sum | humanize : 'number' }}
                  <small>
                    <span *ngIf="!isSummary" class="text-primary non-summary-info">
                      <span>{{ queryDetails?.Metrics2?.Rows_examined_sum_of_total | humanize : 'percent' }}</span> of total
                    </span>
                    <span class="text-success">
                      {{ queryDetails?.Metrics2?.Rows_examined_sum_per_rows | humanize : 'number' }} per row sent
                    </span>
                  </small>
                </span>
              </div>
              <div class="flex-container">
                <div class=" justify-content-start">
                  <span
                    class="unit unit-avg">{{ queryDetails?.Metrics2?.Rows_examined_avg | humanize : 'number' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="number"
                     [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="Rows_examined">
                </div>
              </div>
            </div>
            <div *ngIf="queryDetails?.Metrics2?.Rows_affected_sum" class="table-body-row grid-container">
              <div><span>Rows Affected</span></div>
              <div class="flex-container">
                <div class=" justify-content-start">
                  <span class="unit unit-per-sec">{{ queryDetails?.Metrics2?.Rows_affected_sum_per_sec | humanize : 'number' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                     data-tooltip="Loading..." xkey="Ts" ykey="Rows_affected_sum_per_sec" measurement="number">
                </div>
              </div>
              <div class="">
                <span class="sum text-left">{{ queryDetails?.Metrics2?.Rows_affected_sum | humanize : 'number'}}
                  <small>
                    <span *ngIf="!isSummary" class="text-primary non-summary-info">
                      <span>{{ queryDetails?.Metrics2?.Rows_affected_sum_of_total | humanize : 'percent' }}</span> of total
                    </span>
                  </small>
                </span>
              </div>
              <div class="flex-container">
                <div class=" justify-content-start">
                  <span
                    class="unit unit-avg">{{ queryDetails?.Metrics2?.Rows_affected_avg | humanize : 'number' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="number"
                     [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="Rows_affected">
                </div>
              </div>
            </div>
            <div *ngIf="queryDetails?.Metrics2?.Filesort_sum" class="table-body-row grid-container">
              <div>no avg</div>
              <div class=""><span>External Sorts<small>(Filesort)</small></span></div>
              <div class="flex-container">
                <div class=" justify-content-start">
                  <span class="unit unit-per-sec">{{ queryDetails?.Metrics2?.Filesort_sum_per_sec | humanize : 'number' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                     data-tooltip="Loading..." xkey="Ts" ykey="Filesort_sum_per_sec" measurement="number">
                </div>
              </div>
              <div class="">
                <span class="sum text-left">{{ queryDetails?.Metrics2?.Filesort_sum | humanize : 'number' }}
                  <small>
                    <span *ngIf="!isSummary" class="text-primary non-summary-info">
                      <span>{{ queryDetails?.Metrics2?.Filesort_sum_of_total | humanize : 'percent' }}</span> of total
                    </span>
                    <span class="text-success">
                      <span>{{ queryDetails?.Metrics2?.Filesort_sum_per_query | humanize : 'percent' }}</span> of queries
                    </span>
                  </small>
                </span>
              </div>
              <div>
                -
              </div>
            </div>
            <div *ngIf="queryDetails?.Metrics2?.Filesort_on_disk_sum" class="table-body-row grid-container">
              <div class="cell-overlay position-static">
                <span>External Sorts of Disk<small>(Filesort on disk)</small></span>
              </div>
              <div class="flex-container">
                <div class=" justify-content-start">
                  <span class="unit unit-per-sec">{{ queryDetails?.Metrics2?.Filesort_on_disk_sum_per_sec | humanize : 'number' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                     data-tooltip="Loading..." xkey="Ts" ykey="Filesort_on_disk_sum_per_sec"
                     measurement="number">
                </div>
              </div>
              <div class="">
                <span class="sum text-left">{{ queryDetails?.Metrics2?.Filesort_on_disk_sum | humanize : 'number' }}
                  <small>
                    <span *ngIf="!isSummary" class="text-primary non-summary-info">
                      <span>{{ queryDetails?.Metrics2?.Filesort_on_disk_sum_of_total | humanize : 'percent' }}</span> of total
                    </span>
                    <span class="text-success">
                      <span>{{ queryDetails?.Metrics2?.Filesort_on_disk_sum_per_query | humanize : 'percent' }}</span> of queries
                    </span>
                  </small>
                </span>
              </div>
              <div class="text-xs-right">
                -
              </div>
            </div>
            <div *ngIf="queryDetails?.Metrics2?.Merge_passes_sum" class="table-body-row grid-container">
              <div class="cell-overlay position-static">
                <span>External Sort Passes<small>(Merge Passes)</small></span>
              </div>
              <div class="flex-container">
                <div class=" rate-sec">
                  <span class="unit unit-per-sec">{{ queryDetails?.Metrics2?.Merge_passes_sum_per_sec | humanize : 'number' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                     data-tooltip="Loading..." xkey="Ts" ykey="Merge_passes_sum_per_sec" measurement="number">
                </div>
              </div>
              <div class="">
                <span>{{ queryDetails?.Metrics2?.Merge_passes_sum | humanize : 'number' }}
                  <small>
                    <span *ngIf="!isSummary" class="text-primary non-summary-info">
                      <span>{{ queryDetails?.Metrics2?.Merge_passes_sum_of_total | humanize : 'percent' }}</span> of total
                    </span>
                    <span class="text-success">
                      <span>{{ queryDetails?.Metrics2?.Merge_passes_sum_per_external_sort | humanize : 'percent' }}</span> per external sort
                    </span>
                  </small>
                </span>
              </div>
              <div class="flex-container">
                <div class=" justify-content-start">
                  <span
                    class="unit unit-avg">{{ queryDetails?.Metrics2?.Merge_passes_avg | humanize : 'number' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="number"
                     [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="Merge_passes">
                </div>
              </div>
            </div>
            <div *ngIf="queryDetails?.Metrics2?.Full_join_sum" class="table-body-row grid-container">
              <div class="cell-overlay position-static">
                <span>Cartesian Products<small>(Full Joins)</small></span>
              </div>
              <div class="flex-container">
                <div>
                  <span class="unit unit-per-sec">{{ queryDetails?.Metrics2?.Full_join_sum_per_sec | humanize : 'number' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                     data-tooltip="Loading..." xkey="Ts" ykey="Full_join_sum_per_sec" measurement="number">
                </div>
              </div>
              <div class="">
                <span>{{ queryDetails?.Metrics2?.Full_join_sum | humanize : 'number' }}
                  <small>
                    <span *ngIf="!isSummary" class="text-primary non-summary-info">
                      <span>{{ queryDetails?.Metrics2?.Full_join_sum_of_total | humanize : 'percent' }}</span> of total
                    </span>
                    <span class="text-success">
                      <span>{{ queryDetails?.Metrics2?.Full_join_sum_per_query | humanize : 'percent' }}</span> of queries
                    </span>
                  </small>
                </span>
              </div>
              <div class="text-xs-right">
                -
              </div>
            </div>
            <div *ngIf="queryDetails?.Metrics2?.Full_scan_sum" class="table-body-row grid-container">
              <div class="cell-overlay position-static"><span>Full Table Scans</span></div>
              <div class="flex-container">
                <div>
                  <span class="unit unit-per-sec">{{ queryDetails?.Metrics2?.Full_scan_sum_per_sec | humanize : 'number' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                     data-tooltip="Loading..." xkey="Ts" ykey="Full_scan_sum_per_sec" measurement="number">
                </div>
              </div>
              <div class="">
                <span class="sum text-left">{{ queryDetails?.Metrics2?.Full_scan_sum | humanize : 'number' }}
                  <small>
                    <span *ngIf="!isSummary" class="text-primary non-summary-info">
                      <span>{{ queryDetails?.Metrics2?.Full_scan_sum_of_total | humanize : 'percent' }}</span> of total
                    </span>
                    <span class="text-success">
                      <span>{{ queryDetails?.Metrics2?.Full_scan_sum_per_query | humanize : 'percent' }}</span> of queries
                    </span>
                  </small>
                </span>
              </div>
              <div class="text-xs-right">
                -
              </div>
            </div>
            <div *ngIf="queryDetails?.Metrics2?.Tmp_table_sum" class="table-body-row grid-container">
              <div class="cell-overlay position-static"><span>Queries Requiring Tmp Table In Memory</span></div>
              <div class="flex-container">
                <div class="">
                  <span class="unit unit-per-sec">{{ queryDetails?.Metrics2?.Tmp_table_sum_per_sec | humanize : 'number' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                     data-tooltip="Loading..." xkey="Ts" ykey="Tmp_table_sum_per_sec" measurement="number">
                </div>
              </div>
              <div class="">
                <span class="sum text-left">{{ queryDetails?.Metrics2?.Tmp_table_sum | humanize : 'number' }}
                  <small>
                    <span *ngIf="!isSummary" class="text-primary non-summary-info">
                      <span>{{ queryDetails?.Metrics2?.Tmp_table_sum_of_total | humanize : 'percent' }}</span> of total
                    </span>
                    <span class="text-success">
                      <span>{{ queryDetails?.Metrics2?.Tmp_table_sum_per_query | humanize : 'percent' }}</span> of queries
                    </span>
                  </small>
                </span>
              </div>
              <div class="text-xs-right">
                -
              </div>
            </div>
            <div *ngIf="queryDetails?.Metrics2?.Tmp_tables_sum" class="table-body-row grid-container">
              <div class="cell-overlay position-static"><span>Number of Tmp table in Memory</span></div>
              <div class="flex-container">
                <div class=" rate-sec">
                  <span>{{ queryDetails?.Metrics2?.Tmp_tables_sum_per_sec | humanize : 'number' }} (per sec)</span>
                </div>
                <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                     data-tooltip="Loading..." xkey="Ts" ykey="Tmp_tables_sum_per_sec" measurement="number">
                </div>
              </div>
              <div class="">
                <span class="sum text-left">{{ queryDetails?.Metrics2?.Tmp_tables_sum | humanize : 'number' }}
                  <small>
                    <span *ngIf="!isSummary" class="text-primary non-summary-info">
                      <span>{{ queryDetails?.Metrics2?.Tmp_tables_sum_of_total | humanize : 'percent' }}</span> of total
                    </span>
                    <span class="text-success">
                      {{ queryDetails?.Metrics2?.Tmp_tables_sum_per_query_with_tmp_table | humanize : 'number'}} per query with tmp table
                    </span>
                  </small>
                </span>
              </div>
              <div class="flex-container">
                <div class=" justify-content-start">
                  <span class="unit unit-avg">{{ queryDetails?.Metrics2?.Tmp_tables_avg | humanize : 'number' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="number"
                     [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="Tmp_tables">
                </div>
              </div>
            </div>
            <div *ngIf="queryDetails?.Metrics2?.Tmp_table_on_disk_sum" class="table-body-row grid-container">
              <div class="cell-overlay position-static"><span>Queries Requiring Tmp Table on Disk</span></div>
              <div class="flex-container">
                <div class=" rate-sec">
                  <span class="unit unit-per-sec">{{ queryDetails?.Metrics2?.Tmp_table_on_disk_sum_per_sec | humanize : 'number' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                     data-tooltip="Loading..." xkey="Ts" ykey="Tmp_table_on_disk_sum_per_sec"
                     measurement="number">
                </div>
              </div>
              <div class=" justify-content-start">
                <span class="sum text-left">{{ queryDetails?.Metrics2?.Tmp_table_on_disk_sum | humanize : 'number' }}
                  <small>
                    <span *ngIf="!isSummary" class="text-primary non-summary-info">
                      <span>{{ queryDetails?.Metrics2?.Tmp_table_on_disk_sum_of_total | humanize : 'percent' }}</span> of total
                    </span>
                    <span class="text-success">
                      <span>{{ queryDetails?.Metrics2?.Tmp_table_on_disk_sum_per_query | humanize : 'percent' }}</span> of queries
                    </span>
                  </small>
                </span>
              </div>
              <div class="text-xs-right">
                -
              </div>
            </div>
            <div *ngIf="queryDetails?.Metrics2?.Tmp_disk_tables_sum" class="table-body-row grid-container">
              <div class="cell-overlay position-static"><span>Number of Tmp Tables on Disk</span></div>
              <div class="flex-container">
                <div class=" rate-sec">
                  <span class="unit unit-per-sec">{{ queryDetails?.Metrics2?.Tmp_disk_tables_sum_per_sec | humanize : 'number' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                     data-tooltip="Loading..." xkey="Ts" ykey="Tmp_disk_tables_sum_per_sec"
                     measurement="number">
                </div>
              </div>
              <div class="">
                <span class="sum text-left">{{ queryDetails?.Metrics2?.Tmp_disk_tables_sum | humanize : 'number' }}
                  <small>
                    <span *ngIf="!isSummary" class="text-primary non-summary-info">
                      <span>{{ queryDetails?.Metrics2?.Tmp_disk_tables_sum_of_total | humanize : 'percent' }}</span> of total
                    </span>
                    <span class="text-success">
                     {{ queryDetails?.Metrics2?.Tmp_disk_tables_sum_per_query_with_tmp_table | humanize : 'number' }} per query with disk tmp table
                    </span>
                  </small>
                </span>
              </div>
              <div class="flex-container">
                <div class="text-xs-right  justify-content-start">
                  <span
                    class="unit unit-avg">{{ queryDetails?.Metrics2?.Tmp_disk_tables_avg | humanize : 'number' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="number"
                     [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="Tmp_disk_tables">
                </div>
              </div>
            </div>
            <div *ngIf="queryDetails?.Metrics2?.Tmp_table_sizes_sum" class="table-body-row grid-container">
              <div class="cell-overlay position-static"><span>Total Size of Tmp Tables</span></div>
              <div class="flex-container">
                <div class="">
                  <span class="unit unit-per-sec">{{ queryDetails?.Metrics2?.Tmp_table_sizes_sum_per_sec | humanize : 'size' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" [appLoadSparklines]="queryDetails?.Sparks2"
                     data-tooltip="Loading..." xkey="Ts" ykey="Tmp_table_sizes_sum_per_sec"
                     measurement="size">
                </div>
              </div>
              <div class="">
          <span class="sum text-left">{{ queryDetails?.Metrics2?.Tmp_table_sizes_sum | humanize : 'size' }}
            <small>
              <span *ngIf="!isSummary" class="text-primary non-summary-info">
                <span>{{ queryDetails?.Metrics2?.Tmp_table_sizes_sum_of_total | humanize : 'percent' }}</span> of total
              </span>
              <span class="text-success">
                {{ queryDetails?.Metrics2?.Tmp_table_sizes_sum_per_query_with_any_tmp_table | humanize : 'size' }} per query
              </span>
            </small>
          </span>
              </div>
              <div class="flex-container">
                <div class=" justify-content-start">
                  <span
                    class="unit unit-avg">{{ queryDetails?.Metrics2?.Tmp_table_sizes_avg | humanize : 'size' }}</span>
                </div>
                <div class="scaling-svg-container app-tooltip" data-tooltip="Loading..." measurement="size"
                     [appLatencyChart]="queryDetails?.Metrics2" metricPrefix="Tmp_table_sizes">
                </div>
              </div>
            </div>
          </div>
        </div>
      </ng-template>
    </ngb-panel>
  </ngb-accordion>
</section>
<!--- additional info for query only-->
<div class="sections-wrapper" *ngIf="!isSummary">
  <section class="query" *ngIf="!!fingerprint || !!queryExample">
    <header class="section-title">
      <h3 class="d-flex">QUERY</h3>
    </header>
    <ngb-accordion [activeIds]="accordionIds.querySection" #queryAcc="ngbAccordion">
      <ngb-panel *ngIf="!!fingerprint" id="query-fingerprint">
        <ng-template ngbPanelTitle>
          <div class="accordion-title">
            <h5>Fingerprint</h5>
          </div>
        </ng-template>
        <ng-template ngbPanelContent>
          <i *ngIf="isLoading" class="fa fa-spinner fa-pulse fa-3x fa-fw loading"></i>
          <div class="data-output" *ngIf="!isLoading">
            <pre><code [innerHTML]="fingerprint"></code></pre>
            <button class="pmm-button"
                    id="copyFingerprint"
                    ngxClipboard
                    [cbContent]="queryDetails.Query.Fingerprint"
                    (cbOnSuccess)="showSuccessNotification('fingerprint')"
                    [class.btn-copied]="isCopied.fingerprint">Copy to clipboard
            </button>
          </div>
        </ng-template>
      </ngb-panel>
      <ngb-panel *ngIf="!!queryExample" class="query-example query-panel" id="query-example">
        <ng-template ngbPanelTitle class="ngb-panel-title">
          <div class="accordion-title">
            <h5 class="title">Example</h5>
          </div>
        </ng-template>
        <ng-template ngbPanelContent>
          <i *ngIf="isLoading" class="fa fa-spinner fa-pulse fa-3x fa-fw loading"></i>
          <div class="data-output" *ngIf="!isLoading">
            <pre><code [innerHTML]="queryExample"></code></pre>
            <button class="pmm-button"
                    id="copyQueryExample"
                    ngxClipboard
                    [cbContent]="queryDetails.Example.Query"
                    (cbOnSuccess)="showSuccessNotification('queryExample')"
                    [class.btn-copied]="isCopied.queryExample">Copy to clipboard
            </button>
          </div>
        </ng-template>
      </ngb-panel>
    </ngb-accordion>
  </section>

  <section class="explain"
           *ngIf="!!queryExample || classicExplainError || !!jsonExplain || !!jsonExplainError || !!visualExplain || !!visualExplainError">
    <header class="section-title">
      <h3>EXPLAIN</h3>
      <form class="search-input explain-search-input">
        <i class="fa fa-database" aria-hidden="true"></i>
        <input type="text" class="form-control"
               [(ngModel)]="dbName" [ngModelOptions]="{standalone: true}"
               id="databaseInput" placeholder="`database-name`">
        <button class="search-button" [disabled]="!dbName" (click)="getExplain();" type="submit">
          EXPLAIN
        </button>
      </form>
    </header>
    <ngb-accordion [activeIds]="accordionIds.explainSection" class="accordion-inner-table">
      <ngb-panel id="classic-explain">
        <ng-template ngbPanelTitle>
          <div class="accordion-title">
            <h5>CLASSIC</h5>
          </div>
        </ng-template>
        <ng-template ngbPanelContent>
          <i *ngIf="isExplainLoading" class="fa fa-spinner fa-pulse fa-3x fa-fw loading"></i>
          <div *ngIf="!isExplainLoading && classicExplainError" class="alert alert-warning w-75 mx-auto m-2"
               role="alert">
            <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
            {{ jsonExplainError }}
          </div>
          <div class="table-wrapper classic-table-wrapper" *ngIf="!isExplainLoading && !classicExplainError">
            <div class="table-header classic-table-row table-header-row">
              <div title="Id">Id</div>
              <div title="SelectType">SelectType</div>
              <div title="Table">Table</div>
              <div title="Partitions">Partitions</div>
              <div title="CreateTable">CreateTable</div>
              <div title="Type">Type</div>
              <div title="PossibleKeys">PossibleKeys</div>
              <div title="Key">Key</div>
              <div title="KeyLen">KeyLen</div>
              <div title="Ref">Ref</div>
              <div title="Rows">Rows</div>
              <div title="Extra">Extra</div>
            </div>
            <div class="table-body-row classic-table-row" *ngFor="let row of classicExplain; let i = index">
              <div [attr.title]="row.Id">{{ row.Id }}</div>
              <div [attr.title]="row.SelectType">{{ row.SelectType }}</div>
              <div [attr.title]="row.Table">{{ row.Table }}</div>
              <div [attr.title]="row.Partitions">{{ row.Partitions }}</div>
              <div [attr.title]="row.CreateTable">{{ row.CreateTable }}</div>
              <div [attr.title]="row.Type">{{ row.Type }}</div>
              <div [attr.title]="row.PossibleKeys">{{ row?.PossibleKeys?.replace(',', ', ') }}</div>
              <div [attr.title]="row.Key">{{ row.Key }}</div>
              <div [attr.title]="row.KeyLen">{{ row.KeyLen }}</div>
              <div [attr.title]="row.Ref">{{ row.Ref }}</div>
              <div [attr.title]="row.Rows">{{ row.Rows }}</div>
              <div [attr.title]="row.Extra">{{ row.Extra }}</div>
            </div>
          </div>
        </ng-template>
      </ngb-panel>

      <ngb-panel id="json-explain" *ngIf="!!jsonExplain || !!jsonExplainError">
        <ng-template ngbPanelTitle>
          <div class="accordion-title">
            <h5>JSON</h5>
          </div>
        </ng-template>
        <ng-template ngbPanelContent>
          <i *ngIf="isExplainLoading" class="fa fa-spinner fa-pulse fa-3x fa-fw loading"></i>
          <div class="data-output" *ngIf="!isExplainLoading && !jsonExplainError">
            <app-json-tree [json]="jsonExplain"></app-json-tree>
            <button class="pmm-button"
                    id="copyJson"
                    ngxClipboard
                    [cbContent]="jsonExplainString"
                    (cbOnSuccess)="showSuccessNotification('jsonExplain')"
                    [class.btn-copied]="isCopied.jsonExplain">Copy to clipboard
            </button>
          </div>
          <div *ngIf="!isExplainLoading && jsonExplainError" class="alert alert-warning w-75 mx-auto m-2" role="alert">
            <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
            {{ jsonExplainError }}
          </div>
        </ng-template>
      </ngb-panel>

      <ngb-panel id="visual-explain" *ngIf="!!visualExplain || !!visualExplainError">
        <ng-template ngbPanelTitle>
          <div class="accordion-title">
            <h5>VISUAL</h5>
          </div>
        </ng-template>
        <ng-template ngbPanelContent>
          <i *ngIf="isExplainLoading" class="fa fa-spinner fa-pulse fa-3x fa-fw loading"></i>
          <div class="data-output" *ngIf="!isExplainLoading && !visualExplainError">
            <pre>{{ visualExplain }}</pre>
            <button class="pmm-button"
                    id="copyVisualExplain"
                    ngxClipboard
                    [cbContent]="visualExplain"
                    (cbOnSuccess)="showSuccessNotification('visualExplain')"
                    [class.btn-copied]="isCopied.visualExplain">Copy to clipboard
            </button>
          </div>
          <div *ngIf="!isExplainLoading && visualExplainError" class="alert alert-warning w-75 mx-auto m-2"
               role="alert">
            <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
            {{ visualExplainError }}
          </div>
        </ng-template>
      </ngb-panel>
    </ngb-accordion>
  </section>

  <section class="tables"
           *ngIf="!!createTable || !!createTableError || !!statusTable || !!statusTableError || !!indexTable || !!indexTableError">
    <header class="section-title">
      <h3>TABLES</h3>
      <form class="search-input tables-input" (submit)="addDBTable();">
        <label for="dbTblNamesInput">DB and table</label>
        <input type="text" size="50" class="form-control"
               id="dbTblNamesInput" [(ngModel)]="newDBTblNames"
               [ngModelOptions]="{standalone: true}"
               placeholder="`database-name`.`table-name`">
        <button [disabled]="!newDBTblNames" (click)="addDBTable();"
                class="search-button" type="submit">
          ADD
        </button>
      </form>
    </header>
    <section class="item-buttons-wrapper">
      <div *ngFor="let item of tables" class="btn-group" role="group" aria-label="Tables">
        <button type="button" class="btn-tables" (click)="selectTableInfo(item.Db, item.Table);"
                [ngClass]="isSelectedDbTbl(item) ? 'checked' : ''">
          `{{ item.Db }}`.`{{ item.Table }}`
        </button>
        <button type="button" class="btn-tables btn-tables-remove" (click)="removeDBTable(item);">
          <i class="fa fa-times" aria-hidden="true"></i>
        </button>
      </div>
    </section>
    <ngb-accordion [activeIds]="accordionIds.tableSection">
      <ngb-panel id="table-create" *ngIf="!!createTable || !!createTableError">
        <ng-template ngbPanelTitle>
          <div class="accordion-title">
            <h5>CREATE</h5>
            <p *ngIf="isDBGuessed">(table schema is guessed)</p>
          </div>
        </ng-template>
        <ng-template ngbPanelContent>
          <i *ngIf="isQueryInfoLoading" class="fa fa-spinner fa-pulse fa-3x fa-fw loading"></i>
          <div class="data-output" *ngIf="!isQueryInfoLoading && createTableError">
            <div class="alert alert-warning w-75 mx-auto m-2"
                 role="alert">
              <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
              {{ createTableError }}
            </div>
          </div>
          <div class="data-output" *ngIf="!isQueryInfoLoading && !createTableError">
            <pre><code [innerHTML]="createTable"></code></pre>
            <button class="pmm-button"
                    id="copyCreateTable"
                    ngxClipboard
                    [cbContent]="tableInfo.Create"
                    (cbOnSuccess)="showSuccessNotification('createTable')"
                    [class.btn-copied]="isCopied.createTable">Copy to clipboard
            </button>
          </div>
        </ng-template>
      </ngb-panel>

      <ngb-panel id="table-status" class="accordion-inner-table" *ngIf="!!statusTable || !!statusTableError">
        <ng-template ngbPanelTitle>
          <div class="accordion-title">
            <h5>STATUS</h5>
            <p *ngIf="isDBGuessed">(table schema is guessed)</p>
          </div>
        </ng-template>
        <ng-template ngbPanelContent class="accordion-inner-table">
          <i *ngIf="isQueryInfoLoading" class="fa fa-spinner fa-pulse fa-3x fa-fw loading"></i>
          <div *ngIf="!isQueryInfoLoading && !!statusTableError" class="alert alert-warning w-75 mx-auto m-2"
               role="alert">
            <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
            {{ statusTableError }}
          </div>
          <div class="table-wrapper status-table-wrapper" *ngIf="!isQueryInfoLoading && !statusTableError">
            <div class="table-header grid-container table-header-row">
              <div>Name</div>
              <div>Value</div>
            </div>
            <div class="table-body grid-container" *ngFor="let item of tableInfo?.Status | mapToIterable">
              <div>{{ item.key }}</div>
              <div
                *ngIf="['AvgRowLength', 'DataLength', 'IndexLength', 'DataFree', 'MaxDataLength'].indexOf(item.key) > -1">
                {{ item.val | humanize : 'size' }}
              </div>
              <div *ngIf="['Rows'].indexOf(item.key) > -1">{{ item.val | humanize : 'number' }}</div>
              <div
                *ngIf="['Rows', 'AvgRowLength', 'DataLength', 'IndexLength', 'DataFree', 'MaxDataLength'].indexOf(item.key) === -1">
                {{ item.val === null ? '-' : item.val }}
              </div>
              <div *ngIf="tableInfo?.Status?.length === 0">No data.</div>
            </div>
          </div>
        </ng-template>
      </ngb-panel>

      <ngb-panel id="table-indexes" *ngIf="!!indexTable || !!indexTableError">
        <ng-template ngbPanelTitle>
          <div class="accordion-title">
            <h5>INDEXES</h5>
            <p *ngIf="isDBGuessed">(table schema is guessed)</p>
          </div>
        </ng-template>
        <ng-template ngbPanelContent class="accordion-inner-table">
          <i *ngIf="isQueryInfoLoading" class="fa fa-spinner fa-pulse fa-3x fa-fw loading table-spinner"></i>
          <div *ngIf="!isQueryInfoLoading && !!indexTableError"
               class="alert alert-warning w-75 mx-auto m-2 index-table-error"
               role="alert">
            <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
            {{ indexTableError }}
          </div>
          <div class="table-wrapper indexes-table" *ngIf="!isQueryInfoLoading && !indexTableError">
            <div class="table-header grid-container table-header-row">
              <div>KeyName</div>
              <div>Type</div>
              <div>Unique</div>
              <div>Packed</div>
              <div>Column</div>
              <div>Cardinality</div>
              <div>Collation</div>
              <div>Null</div>
              <div>Comment</div>
            </div>
            <div class="grid-container-wrapper" *ngFor="let ind of tableInfo?.Index | mapToIterable">
              <div class="table-body grid-container" *ngFor="let row of ind.val; let isFirst = first">
                <div>
                  <div *ngIf="isFirst">{{ row.KeyName }}</div>
                </div>
                <div>
                  <div *ngIf="isFirst">{{ row.IndexType }}</div>
                </div>
                <div>
                  <div *ngIf="isFirst">{{ row.NonUnique === false ? 'Yes' : 'No' }}</div>
                </div>
                <div>
                  <div *ngIf="isFirst">{{ row.Packed ? 'Yes' : 'No' }}</div>
                </div>
                <div>{{ row.ColumnName }}</div>
                <div>{{ row.Cardinality }}</div>
                <div>{{ row.Collation }}</div>
                <div>{{ row.Null ? 'Yes' : 'No' }}</div>
                <div>
                  <div *ngIf="isFirst">{{ row.Comment }}</div>
                </div>
              </div>
              <div *ngIf="tableInfo?.Index?.length === 0" class="no-data">No data.</div>
            </div>
          </div>
        </ng-template>
      </ngb-panel>
    </ngb-accordion>
  </section>

  <section class="procedures"
    *ngIf="!!createProcedure || !!createProcedureError">
    <header class="section-title">
      <h3>PROCEDURES</h3>
      <form class="search-input tables-input" (submit)="addDBProcedure();">
        <label for="dbProcedureNamesInput" style="white-space: nowrap;">DB and name</label>
        <input type="text" size="50" class="form-control" id="dbProcedureNamesInput" [(ngModel)]="newDBProcedureNames"
          [ngModelOptions]="{standalone: true}" placeholder="`database`.`procedure`">
        <button [disabled]="!newDBProcedureNames" (click)="addDBProcedure();" class="search-button" type="submit">
          ADD
        </button>
      </form>
    </header>
    <section class="item-buttons-wrapper">
      <div *ngFor="let item of queryDetails?.Query?.Procedures" class="btn-group" role="group" aria-label="Procedures">
        <button type="button" class="btn-tables" (click)="selectProcedureInfo(item.DB, item.Name);"
          [ngClass]="isSelectedDbProcedure(item) ? 'checked' : ''">
          `{{ item.DB }}`.`{{ item.Name }}`
        </button>
        <button type="button" class="btn-tables btn-tables-remove" (click)="removeDBProcedure(item);">
          <i class="fa fa-times" aria-hidden="true"></i>
        </button>
      </div>
    </section>
    <ngb-accordion [activeIds]="accordionIds.procedureSection">
      <ngb-panel id="procedure-create" *ngIf="!!createProcedure || !!createProcedureError">
        <ng-template ngbPanelTitle>
          <div class="accordion-title">
            <h5>CREATE</h5>
            <p *ngIf="isDBGuessed">(table schema is guessed)</p>
          </div>
        </ng-template>
        <ng-template ngbPanelContent>
          <i *ngIf="isQueryInfoLoading" class="fa fa-spinner fa-pulse fa-3x fa-fw loading"></i>
          <div class="data-output" *ngIf="!isQueryInfoLoading && createProcedureError">
            <div class="alert alert-warning w-75 mx-auto m-2" role="alert">
              <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
              {{ createProcedureError }}
            </div>
          </div>
          <div class="data-output" *ngIf="!isQueryInfoLoading && !createProcedureError">
            <pre><code [innerHTML]="createProcedure"></code></pre>
            <button class="pmm-button" id="copyCreateProcedure" ngxClipboard [cbContent]="procedureInfo.Create"
              (cbOnSuccess)="showSuccessNotification('createProcedure')" [class.btn-copied]="isCopied.createProcedure">Copy to
              clipboard
            </button>
          </div>
        </ng-template>
      </ngb-panel>
    </ngb-accordion>
  </section>

  <section class="views" *ngIf="!!createView || !!createViewError">
    <header class="section-title">
      <h3>VIEWS</h3>
      <form class="search-input tables-input" (submit)="addDBView();">
        <label for="dbViewNamesInput" style="white-space: nowrap;">DB and name</label>
        <input type="text" size="50" class="form-control" id="dbViewNamesInput" [(ngModel)]="newDBViewNames"
          [ngModelOptions]="{standalone: true}" placeholder="`database-name`.`view-name`">
        <button [disabled]="!newDBViewNames" (click)="addDBView();" class="search-button" type="submit">
          ADD
        </button>
      </form>
    </header>
    <section class="item-buttons-wrapper">
      <div *ngFor="let item of views" class="btn-group" role="group" aria-label="Views">
        <button type="button" class="btn-tables" (click)="selectViewInfo(item.Db, item.Table);"
          [ngClass]="isSelectedDbView(item) ? 'checked' : ''">
          `{{ item.Db }}`.`{{ item.Table }}`
        </button>
        <button type="button" class="btn-tables btn-tables-remove" (click)="removeDBView(item);">
          <i class="fa fa-times" aria-hidden="true"></i>
        </button>
      </div>
    </section>
    <ngb-accordion [activeIds]="accordionIds.viewSection">
      <ngb-panel id="view-create" *ngIf="!!createView || !!createViewError">
        <ng-template ngbPanelTitle>
          <div class="accordion-title">
            <h5>CREATE</h5>
            <p *ngIf="isDBGuessed">(table schema is guessed)</p>
          </div>
        </ng-template>
        <ng-template ngbPanelContent>
          <i *ngIf="isQueryInfoLoading" class="fa fa-spinner fa-pulse fa-3x fa-fw loading"></i>
          <div class="data-output" *ngIf="!isQueryInfoLoading && createViewError">
            <div class="alert alert-warning w-75 mx-auto m-2" role="alert">
              <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
              {{ createViewError }}
            </div>
          </div>
          <div class="data-output" *ngIf="!isQueryInfoLoading && !createViewError">
            <pre><code [innerHTML]="createView"></code></pre>
            <button class="pmm-button" id="copyCreateView" ngxClipboard [cbContent]="viewInfo.Create"
              (cbOnSuccess)="showSuccessNotification('createView')"
              [class.btn-copied]="isCopied.createView">Copy to
              clipboard
            </button>
          </div>
        </ng-template>
      </ngb-panel>
    </ngb-accordion>
  </section>

  <section class="user-souurce">
    <header class="section-title">
      <h3>User Sources</h3>
    </header>
    <ngb-accordion [activeIds]="accordionIds.userSourceSection">
      <ngb-panel id="user-source-list">
        <ng-template ngbPanelTitle>
          <div class="accordion-title">
            <h5>ACCOUNTS</h5>
          </div>
        </ng-template>
        <ng-template ngbPanelContent>
          <i *ngIf="isUserSourceLoading" class="fa fa-spinner fa-pulse fa-3x fa-fw loading"></i>
          <div *ngIf="!isUserSourceLoading && userSourceError" class="alert alert-warning w-75 mx-auto m-2"
               role="alert">
            <i class="fa fa-exclamation-triangle" aria-hidden="true"></i>
            {{ userSourceError }}
          </div>
          <div class="table-wrapper classic-table-wrapper" *ngIf="!isUserSourceLoading && !userSourceError">
            <div class="table-header classic-table-row table-header-row">
              <div title="User">User</div>
              <div title="Host">Host</div>
              <div title="First Seen">First Seen</div>
              <div title="Last Seen">Last Seen</div>
              <div title="Count">Count</div>
            </div>
            <div class="table-body-row classic-table-row" *ngFor="let row of userSources; let i = index">
              <div [attr.title]="row.User">{{ row.User }}</div>
              <div [attr.title]="row.Host">{{ row.Host }}</div>
              <div [attr.title]="row.FirstSeen">{{ row.FirstSeen / 1000000 | date:'yyyy-MM-dd HH:mm:ss' }}</div>
              <div [attr.title]="row.LastSeen">{{ row.LastSeen / 1000000 | date:'yyyy-MM-dd HH:mm:ss' }}</div>
              <div [attr.title]="row.Count">{{ row.Count }}</div>
            </div>
          </div>
        </ng-template>
      </ngb-panel>
    </ngb-accordion>
  </section>

  <div class="row justify-content-md-center">
    <button *ngIf="!isLoading && !isQueryInfoLoading && !isExplainLoading"
          (click)="downloadReport()" class="pmm-button-big checked">
        <i class="fa fa-file-archive-o" aria-hidden="true"></i>
        Download Report
    </button>
  </div>
</div>
